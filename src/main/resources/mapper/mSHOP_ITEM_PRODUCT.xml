<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Shop_Item_Product">

<resultMap id="ShopItemProductResultMap" type="com.osd.web.app.dto.Shop_Item_ProductDto">
	<result column="ITEM_PRODUCT_ID" property="item_product_id"/>
	<result column="ITEM_ID" property="item_id"/>
    <result column="PRODUCT_ID" property="product_id"/>
    <result column="PRODUCT_QUANTITY" property="product_quantity"/>

</resultMap>
		 
<select id="selectAll" resultMap="ShopItemProductResultMap">
	select * from shop_item_product
</select>

<insert id="insert" parameterType="Shop_Item_ProductDto">
	insert into shop_item_product
		(item_id, product_id, product_quantity)
	values
		(#{item_id}, #{product_id}, #{product_quantity})
</insert>

<select id="selectByItem" parameterType="String" resultMap="ShopItemProductResultMap">
	select * from shop_item_product
	<where>
		item_id = #{item_id}
	</where>
</select>

<update id="updateProductAndQuantity" parameterType="Shop_Item_ProductDto">
	update shop_item_product 
	<set>
		product_id = #{product_id}, 
		product_quantity = #{product_quantity} 
	</set>
	where item_product_id = #{item_product_id}
</update>

<delete id="deleteByNotInId" parameterType="List">
	DELETE FROM shop_item_product
    	WHERE item_product_id NOT IN
    	<foreach collection="list" item="item_product_id" open="(" separator="," close=")">
        	#{item_product_id}
    	</foreach>
</delete>
		
</mapper>